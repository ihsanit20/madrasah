import{V}from"./ValidationErrors-8c7933f9.js";import{B as N}from"./Button-d2cfadaa.js";import{I}from"./Input-1bd0d71e.js";import{S as j}from"./Select-66ca7783.js";import{F as C}from"./FormGroup-1b05500d.js";import{I as B}from"./InlineData-e210fbea.js";import{r as n,o as d,c as f,b as t,a as l,w as _,F as b,f as y,t as m,n as v,d as k,e as A}from"./app-d3163295.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";import"./Label-2b9725af.js";const F={components:{ValidationErrors:V,Button:N,Input:I,Select:j,FormGroup:C,InlineData:B},props:{moduleAction:String,buttonValue:{type:String,default:"Save"},data:{type:Object,default:{}},paidPurposeIds:{type:Array,default:[]}},created(){this.moduleAction=="store"&&this.setDefaultSaraly(),this.moduleAction=="update"&&(this.form.salaries=this.data.staff.salaries.find(e=>e.purpose_id===this.form.purpose_id)||[])},computed:{totalSalary(){let e=this.form.salaries.reduce(function(s,o){return s+parseInt(o.amount)},0);return e=isNaN(e)?0:e,this.form.total=e,e},dueSalary(){let e=this.totalSalary,s=parseInt(this.form.cut||0),o=parseInt(this.form.paid||0),c=e-s-o;return this.form.due=c,c}},data(){return{form:this.$inertia.form({purpose_id:"",salaries:[],total:"",paid:"",due:"",cut:0})}},methods:{submit(){return this.form.purpose_id?this.moduleAction=="store"?this.form.post(this.route("staff.salaries.store",this.data.staff.id)):alert("Something wrong...!"):alert("বাবদ নির্বাচন করুন")},setDefaultSaraly(){this.form.salaries=[...this.data.staff.default_salaries||[]],this.data.staff.due&&this.form.salaries.unshift({title:"বকেয়া",amount:this.data.staff.due})},purposeChangeHandler(){let e=Object.values(this.data.staff.paid_salaries).find(s=>Number(s.purpose_id)===Number(this.form.purpose_id));e?(this.form.salaries=[...e.salaries],console.log(e.paid),e.paid&&(this.form.salaries.push({title:"কর্তন",amount:-e.cut}),this.form.salaries.push({title:"বেতন প্রদান",amount:-e.paid}))):this.setDefaultSaraly()}}},H={class:"w-full max-w-xl rounded border bg-white p-4 shadow"},P=t("h3",{class:"text-center text-2xl font-bold text-brand-600"},"বেতন রশিদ",-1),T={class:"flex items-center justify-between"},L={class:"flex items-center justify-between"},M=t("option",{value:""},"-- নির্বাচন করুন --",-1),U=["value","disabled","innerHTML"],E=t("hr",{class:"my-3"},null,-1),O={class:"grid"},q=t("div",{class:"flex justify-between bg-gray-200 py-2 px-3 font-bold"},[t("div",null,"বেতনের বিবরণ"),t("div",null,"নির্ধারিত টাকা")],-1),z={class:"flex justify-end gap-2 border-t py-2 px-3 font-bold"},G=t("div",null,"মোট:",-1),J={class:"flex justify-end gap-2 border-t py-1 px-1.5 font-bold"},K=t("div",null,"কর্তন:",-1),Q={class:"flex justify-end gap-2 border-t py-1 px-1.5 font-bold"},R=t("div",null,"প্রদান:",-1),W={class:"flex justify-end gap-2 border-t py-2 px-2 font-bold"},X=t("div",null,"বকেয়া:",-1),Y=t("hr",{class:"my-4 w-full"},null,-1),Z={class:"flex items-center justify-end"};function $(e,s,o,c,r,u){const p=n("inline-data"),g=n("Select"),x=n("form-group"),S=n("validation-errors"),h=n("Input"),w=n("Button");return d(),f("div",H,[P,t("div",T,[l(p,{title:"রশিদ নং:"}),l(p,{title:"তারিখ:"})]),t("div",L,[l(p,{title:"নাম:",value:o.data.staff.name},null,8,["value"]),l(p,{title:"পদবি:",value:o.data.staff.designationTitle},null,8,["value"])]),l(x,{class:"col-span-full",label:"বাবদ নির্বাচন করুন"},{default:_(()=>[l(g,{class:"block w-full",modelValue:r.form.purpose_id,"onUpdate:modelValue":s[0]||(s[0]=a=>r.form.purpose_id=a),onChange:u.purposeChangeHandler,required:""},{default:_(()=>[M,(d(!0),f(b,null,y(o.data.purposes,(a,i)=>(d(),f("option",{key:i,value:i,disabled:Number(o.data.staff.due_purpose_id)!==Number(i)&&o.paidPurposeIds.includes(Number(i)),innerHTML:(Number(o.data.staff.due_purpose_id)===Number(i)?"⚠ (বকেয়া) ":o.paidPurposeIds.includes(Number(i))?"✓ ":"")+a},null,8,U))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),E,l(S,{class:"mb-4"}),t("form",{onSubmit:s[3]||(s[3]=k((...a)=>u.submit&&u.submit(...a),["prevent"])),class:""},[t("div",O,[q,(d(!0),f(b,null,y(r.form.salaries,(a,i)=>(d(),f("div",{key:i,class:v(["flex justify-between py-2 px-3 font-bold",i%2?"bg-gray-100":""])},[t("div",null,m(a.title),1),t("div",null,m(e.$e2bnumber(a.amount)),1)],2))),128)),t("div",z,[G,t("div",null,m(e.$e2bnumber(u.totalSalary)),1)]),t("div",J,[K,t("div",null,[l(h,{type:"number",modelValue:r.form.cut,"onUpdate:modelValue":s[1]||(s[1]=a=>r.form.cut=a),class:"w-12 py-0.5 px-1 text-right text-red-600"},null,8,["modelValue"])])]),t("div",Q,[R,t("div",null,[l(h,{type:"number",modelValue:r.form.paid,"onUpdate:modelValue":s[2]||(s[2]=a=>r.form.paid=a),class:"w-12 py-0.5 px-1 text-right"},null,8,["modelValue"])])]),t("div",W,[X,t("div",null,m(e.$e2bnumber(u.dueSalary)),1)])]),Y,t("div",Z,[l(w,{class:v(["",{"opacity-25":r.form.processing}]),disabled:r.form.processing},{default:_(()=>[A(m(o.buttonValue),1)]),_:1},8,["class","disabled"])])],32)])}const ut=D(F,[["render",$]]);export{ut as default};
